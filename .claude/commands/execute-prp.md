# 执行PRP (Project Requirements Document)

## 🎯 命令概述

本命令用于执行项目需求文档(PRP)，通过分阶段的用户确认机制确保实现的准确性和质量。

**使用方法**: `/execute-prp`

## 📋 执行流程

### 前置检查阶段

检查PRP目录下文件是否存在
1. 功能需求文档 (PRPs/feature.md)
2. 技术设计方案 (PRPs/technical-design.md)
如果不存在则向用户提醒并结束执行
如果存在则继续检查是否已经存在TASK.md文件

检查是否已经存在TASK.md文件
如果存在，检查当前已经进行到的阶段，并向用户确认当前已经进行到的阶段，询问用户是否确认继续执行当前阶段

### 阶段一：初始化与需求列表创建 (Phase 1: Initialization & Requirements List)

1. **加载PRP与上下文理解**
   - 读取指定的PRP文件，理解所有技术细节和业务需求
   - 分析项目现状，包括现有代码结构、依赖关系等
   - 识别实现所需的所有上下文信息

2. **选择技术栈**
   - 考虑项目需求和团队技能，选择合适的技术栈
   - 考虑项目规模和未来扩展性，选择合适的架构模式
   - 考虑团队成员的技术水平，选择能够支持团队合作的技术栈
   - 整理所有可能的选择以及对应的优缺点和建议，以交互式的方式供用户选择

3. **检查技术栈本地开发环境**
   - 检查项目所需的所有技术栈组件是否已安装在本地开发环境中
   - 检查组件的版本是否与项目要求兼容
   - 检查是否存在必要的配置文件或环境变量
   - 如果开发环境中缺少必要的组件或配置，向用户提醒并提供安装或配置的步骤，等待用户确认本地环境准备就绪后再次执行本步骤进行检查

3. **将当前需求列表转化为迭代开发的需求列表**
   - 考虑项目的迭代开发周期，将当前需求列表分解为多个迭代周期的需求
   - 每个迭代周期的需求列表应包含该周期内需要实现的主要功能
   - 每个迭代周期的产物应当是一个可执行的、功能完善的软件版本
   - 考虑项目的紧急性和功能优先级，合理分配需求到不同的迭代周期

4. **创建TASK.md与需求列表**
   - 创建 `TASK.md` 文件
   - 基于PRP分析，提取未经过细化的核心需求列表
   - 为每个需求设定初步优先级

5. **需求列表审查与确认**
   - 向用户展示需求列表，等待审查意见
   - 根据用户反馈修改需求列表
   - 重复此过程直到用户确认需求列表

### 阶段二：需求细化与任务拆分 (Phase 2: Requirements Refinement & Task Breakdown)

**对每个迭代版本的需求执行以下流程**：

1. **需求分析**
   - 深入分析当前需求的业务逻辑和技术要求
   - 识别需求的边界条件和异常场景
   - 评估实现复杂度和潜在风险

2. **任务拆分**
   - 将需求分解为具体的、可执行的任务清单
   - 为每个任务设定优先级、预估工时和验收标准
   - 识别任务间的依赖关系

3. **任务清单审查与确认**
   - 向用户展示详细的任务清单，等待审查意见
   - 根据用户反馈调整任务拆分方案
   - 重复此过程直到用户确认可以开始执行

### 阶段三：任务执行与实现 (Phase 3: Task Execution & Implementation)

**对每个任务执行以下流程**：

1. **代码实现**
   - 严格按照任务清单实现功能
   - 遵循 `CLAUDE.md` 中的编码规范和代码质量要求
   - 编写清晰的代码注释，说明实现逻辑和设计思路
   - 有失败的情况，要及时记录并向用户汇报
   - 有解决不了的问题，要及时向用户汇报并要求用户提供解决方法

2. **代码质量检查**
   - 严格按照 `CLAUDE.md` 中的编码规范和代码质量要求检查代码
   - 检查代码是否符合最佳实践和设计模式
   - 检查是否存在潜在的性能问题或安全漏洞
   - 如果发现问题，要及时向用户汇报并要求用户修复
   - 完成后提供测试流程并自动进行测试，如果有问题尝试自己修复，然后再次测试。
   - 如果测试通过，向用户汇报任务完成情况，等待我确认进行下一步：文档同步更新。

2. **文档同步更新**
   - 及时更新相关的开发文档
   - 确保代码注释与实际实现保持一致
   - 更新API文档、配置文件等相关资料
   - 向我汇报文档更新情况，等待我确认进行下一步：Git提交。

3. **Git提交**
   - 如果项目是Git仓库，一定要执行这一步，完成单个任务后一定要提交详细的commit
   - Commit信息遵循规范格式，包含任务描述和实现要点
   - 确保提交信息的可追溯性
   - 提交后，向用户汇报commit信息，等待我确认进行下一步：TASK.md状态更新。

4. **TASK.md状态更新**
   - 任务状态分为：已完成、进行中、待开始
   - 标记已完成的任务，记录完成时间
   - 更新任务进度状态
   - 记录实现过程中的重要发现或问题

5. **向用户汇报**
   - 汇报任务完成情况
   - 提供测试建议和验证方法
   - 等待用户确认后继续下一个任务

6. **退出时保存任务进度**
   - 在用户确认退出前，保存当前任务进度到TASK.md文件，方便后续继续执行

### 阶段四：项目完成与最终验证 (Phase 4: Project Completion & Final Validation)

1. **全面检查**
   - 确保所有需求都已完成
   - 验证各模块间的集成是否正常
   - 检查代码质量和文档完整性

2. **最终提交**
   - 进行最终的Git提交（如适用）
   - 生成项目完成报告
   - 更新TASK.md的最终状态

## 📄 TASK.md 标准格式

```markdown
# 项目任务管理文档

## 📋 需求列表 (已确认)
- [x] 需求1：用户认证系统 - [已完成]
- [ ] 需求2：数据可视化模块 - [进行中]
- [ ] 需求3：API接口开发 - [待开始]

## 🎯 任务清单 (需求2: 数据可视化模块)
### 任务2.1: 数据采集模块
- [x] 设计数据采集接口 - [已完成] 2025-11-02 15:30
- [x] 实现数据获取逻辑 - [已完成] 2025-11-02 16:45
- [ ] 数据清洗和预处理 - [进行中]
- [ ] 异常处理机制 - [待开始]

### 任务2.2: 可视化组件
- [ ] 图表组件设计 - [待开始]
- [ ] 交互功能实现 - [待开始]

## 🔍 实现过程记录
- 2025-11-02 16:45 - 完成数据获取逻辑，发现需要添加缓存机制
- 2025-11-02 15:30 - 完成数据采集接口设计

## ✅ 项目完成状态
总体进度: 30% (1/3 需求已完成)
```

## ⚠️ 重要原则

- **用户确认优先**: 每个关键步骤都需要用户确认后方可继续
- **质量第一**: 严格按照编码规范，确保代码质量
- **文档同步**: 代码实现与文档更新必须同步进行
- **渐进式实现**: 一次专注于一个任务，确保质量后再继续
- **及时沟通**: 遇到问题立即反馈，不擅自决策

## 🔄 状态管理

**需求状态**:
- `[待确认]` - 已创建，等待用户审查
- `[已确认]` - 用户已确认，可以开始细化
- `[进行中]` - 正在拆分任务或实现
- `[已完成]` - 所有任务完成并通过验证

**任务状态**:
- `[待开始]` - 已规划，等待执行
- `[进行中]` - 正在实现
- `[已完成]` - 实现完成并通过验证
- `[已阻塞]` - 遇到问题，需要解决

## 📝 Commit信息规范 (Git项目)

```
feat: 添加用户认证功能

- 实现用户注册和登录接口
- 添加JWT token验证机制
- 完善密码加密存储
- 更新相关API文档

Closes #1
```
